CREATE VIEW [dbo].[VNEWF_TLU_SR_SALESREP_ORG_LVL2]
AS
SELECT
       L2.SALESREP_ORG2_LVL2_KEY                SALESREP_ORG_LVL2_KEY
      ,L2.SALESREP_ORG2_LVL2_ID                 SALESREP_ORG_LVL2_ID
      ,L2.SALESREP_ORG2_LVL2_DESCR              SALESREP_ORG_LVL2_DESCR
      ,L2.SALESREP_ORG2_LVL2_ACTIVE_FLAG        SALESREP_ORG_LVL2_ACTIVE_FLAG
      ,L2.PROMPT_FLAG
      ,L2.SALESREP_ORG2_LVL2_SORT               SALESREP_ORG_LVL2_SORT
      ,L2.SALESREP_ORG2_LVL1_KEY                SALESREP_ORG_LVL1_KEY
      ,L2.SALESREP_ORG2_LVL1_ID                 SALESREP_ORG_LVL1_ID
      ,L1.SALESREP_ORG2_LVL1_DESCR              SALESREP_ORG_LVL1_DESCR
      ,L2.CURRENT_FEED_FLAG
      ,L2.DOWNLOAD_FLAG
      ,ISNULL(L2.AUDIT_LOAD_KEY,-2)             AUDIT_LOAD_KEY
      ,ISNULL(L2.FILE_KEY,-2)                   FILE_KEY
      ,L2.CREATE_DATE
      ,L2.CREATE_USER_ID
      ,L2.UPDATE_DATE
      ,L2.UPDATE_USER_ID
      ,L2.SOURCE_SYSTEM_ID
      ,CURRENT_TIMESTAMP                        LOAD_DATE
      ,-3 as CLIENT_KEY
      ,NULL as CLIENT_NAME
FROM LU_CL_SALESREP_ORG2_LVL2 L2
JOIN LU_CL_SALESREP_ORG2_LVL1 L1
  ON L2.SALESREP_ORG2_LVL1_KEY = L1.SALESREP_ORG2_LVL1_KEY


create view [dbo].[VNEWF_LU_ST_AP_ACCT_CLASS]
as select * from LU_ST_AP_ACCT_CLASS;

create view [dbo].[VNEWF_LU_ST_AP_ACCT_GROUP_TYPE]
as select * from LU_ST_AP_ACCT_GROUP_TYPE;

create view [dbo].[VNEWF_LU_ST_AP_ACCT_PREM_TYPE]
as select * from LU_ST_AP_ACCT_PREM_TYPE;

create view [dbo].[VNEWF_LU_ST_AP_ACCT_REGION]
as select * from LU_ST_AP_ACCT_REGION;

create view [dbo].[VNEWF_LU_ST_AP_ACCT_TYPE]
as select * from LU_ST_AP_ACCT_TYPE;

create view [dbo].[VNEWF_LU_ST_AP_CUSTOM_ACCT]
as select * from LU_ST_AP_CUSTOM_ACCT;

create view [dbo].[VNEWF_LU_ST_AP_CUSTOM_ACCT_ENTRY]
as select * from LU_ST_AP_CUSTOM_ACCT_ENTRY;

create view [dbo].[VNEWF_LU_ST_AP_ROW_STATUS]
as select * from LU_ST_AP_ROW_STATUS;

CREATE VIEW [dbo].[VNEWF_STG_RPT_F_DEP_DETAILS]
AS
SELECT
    ROW_ID   ,
    PUBLISH_ID    ,
    PROVIDER_ID    ,
    PROVIDER_SOURCE_ID   ,
    WAREHOUSE_CF_ID as WAREHOUSE_ID_CF    ,
    WAREHOUSE_ID   ,
    TIME_PERIOD_ID as MONTH_ID,
    PROVIDER_PRODUCT_ID   ,
    DI_PRODUCT_LIBRARY_KEY    ,
    PR_DETAIL_ROW_ID    ,
    CLIENT_PRODUCT_ID    ,
    CL_PRODUCT_LIBRARY_KEY    ,
    CLIENT_BASE_PRODUCT_ID     ,
    CL_BASE_PRODUCT_LIBRARY_KEY    ,
    VAP_ID    ,
    BEGINNING_INVENTORY_UNITS   ,
    ADJUSTMENT_UNITS   ,
    TRANSFERS_IN_UNITS   ,
    TRANSFERS_OUT_UNITS   ,
    DEPLETION_UNITS   ,
    ENDING_INVENTORY_UNITS   ,
    RECEIPT_UNITS   ,
    ON_ORDER_UNITS   ,
    WHOLESALE_UNITS   ,
    ON_PREMISE_UNITS   ,
    OFF_PREMISE_UNITS   ,
    BREAKAGE_UNITS   ,
    TRANSPORTATION_UNITS   ,
    SAMPLE_UNITS   ,
    -3 RETURN_UNITS   ,
    MILITARY_UNITS   ,
    BEGINNING_INVENTORY_CASE_DI   ,
    ADJUSTMENT_CASE_DI   ,
    TRANSFERS_IN_CASE_DI   ,
    TRANSFERS_OUT_CASE_DI   ,
    DEPLETION_CASE_DI   ,
    ENDING_INVENTORY_CASE_DI   ,
    RECEIPT_CASE_DI   ,
    ON_ORDER_CASE_DI   ,
    WHOLESALE_CASE_DI   ,
    ON_PREMISE_CASE_DI   ,
    OFF_PREMISE_CASE_DI   ,
    BREAKAGE_CASE_DI   ,
    TRANSPORTATION_CASE_DI   ,
    SAMPLE_CASE_DI   ,
    -3 RETURN_CASE_DI   ,
    MILITARY_CASE_DI   ,
    WHOLESALE_SALES as WHOLESALE_DOLLAR_SALES   ,
    BEGINNING_INVENTORY_CASE_EQ   ,
    ADJUSTMENT_CASE_EQ   ,
    TRANSFERS_IN_CASE_EQ   ,
    TRANSFERS_OUT_CASE_EQ   ,
    DEPLETION_CASE_EQ   ,
    ENDING_INVENTORY_CASE_EQ   ,
    RECEIPT_CASE_EQ   ,
    ON_ORDER_CASE_EQ   ,
    WHOLESALE_CASE_EQ   ,
    ON_PREMISE_CASE_EQ   ,
    OFF_PREMISE_CASE_EQ   ,
    BREAKAGE_CASE_EQ   ,
    TRANSPORTATION_CASE_EQ   ,
    SAMPLE_CASE_EQ   ,
    -3 RETURN_CASE_EQ   ,
    MILITARY_CASE_EQ   ,
    BEGINNING_INVENTORY_CASE_PHYS   ,
    ADJUSTMENT_CASE_PHYS   ,
    TRANSFERS_IN_CASE_PHYS   ,
    TRANSFERS_OUT_CASE_PHYS   ,
    DEPLETION_CASE_PHYS   ,
    ENDING_INVENTORY_CASE_PHYS   ,
    RECEIPT_CASE_PHYS   ,
    ON_ORDER_CASE_PHYS   ,
    WHOLESALE_CASE_PHYS   ,
    ON_PREMISE_CASE_PHYS   ,
    OFF_PREMISE_CASE_PHYS   ,
    BREAKAGE_CASE_PHYS   ,
    TRANSPORTATION_CASE_PHYS   ,
    SAMPLE_CASE_PHYS   ,
    -3 RETURN_CASE_PHYS   ,
    MILITARY_CASE_PHYS   ,
    BEGINNING_INVENTORY_CASE_STD   ,
    ADJUSTMENT_CASE_STD   ,
    TRANSFERS_IN_CASE_STD   ,
    TRANSFERS_OUT_CASE_STD   ,
    DEPLETION_CASE_STD   ,
    ENDING_INVENTORY_CASE_STD   ,
    RECEIPT_CASE_STD   ,
    ON_ORDER_CASE_STD   ,
    WHOLESALE_CASE_STD   ,
    ON_PREMISE_CASE_STD   ,
    OFF_PREMISE_CASE_STD   ,
    BREAKAGE_CASE_STD   ,
    TRANSPORTATION_CASE_STD   ,
    SAMPLE_CASE_STD   ,
    -3 RETURN_CASE_STD   ,
    MILITARY_CASE_STD   ,
    PHYS_CLIENT_CASE_FACTOR   ,
    STD_CLIENT_CASE_FACTOR   ,
    SOURCE_FILE_KEY    ,
    SOURCE_SYSTEM_ID   ,
    ACTIVE_FLAG    ,
    VALPV_ROW_ID    ,
    VERSION    ,
    VALDTL_ROW_ID    ,
    1 as PROMPT_FLAG,
    1 as CURRENT_FEED_FLAG,
    0 as DOWNLOAD_FLAG ,
    -2 as FILE_KEY ,
    -2 AUDIT_LOAD_KEY ,
    CREATE_DATE,
    'ETL' as CREATE_USER_ID  ,
    UPDATE_DATE,
    UPDATE_USER_ID  ,
    current_timestamp as LOAD_DATE
 ,-3 as CLIENT_KEY
,NULL as CLIENT_NAME
from RPT_F_DEP_DETAILS
where  ISNULL(CLIENT_BASE_PRODUCT_ID,'AP00') NOT LIKE 'AP0%'
  and  ROW_ID in (select RPT_ROW_ID from WRK_CDC_RPT_F_DEP_DETAILS where ACTIVE_FLAG = 1);

CREATE VIEW [dbo].[VNEWF_STG_RPT_F_RAD_DETAILS]
as
SELECT
     ROW_ID  ,
     PUBLISH_ID    ,
     PROVIDER_ID    ,
     PROVIDER_SOURCE_ID  ,
     WAREHOUSE_CF_ID as WAREHOUSE_ID_CF    ,
     WAREHOUSE_ID  ,
     TIME_PERIOD_ID as MONTH_ID,
     PROVIDER_CUSTOMER_ID  ,
     CUSTOMER_ROW_ID    ,
     CUSTOMER_ID   ,
     OUTLET_ID   ,
     R.STORE_ID     ,
     SALESPERSON_TEAM_ID   ,
     SALESPERSON_CODE_ID  ,
     SALESPERSON_NAME_ID   ,
     ISNULL(SR.SALESREP_ORG_LVL_LL_KEY,-3) SALESREP_RESPONSIBLE_KEY,
     ISNULL(LL.SALESREP_ORG2_LVL_LL_ID,'*TBD*') SALESREP_RESPONSIBLE_ID,
     -3 SALESREP_ACTUAL_KEY,
     '*TBD*' SALESREP_ACTUAL_ID,
     -3 TEAM_RESPONSIBLE_KEY,
     '*TBD*' TEAM_RESPONSIBLE_ID,
     -3 TEAM_ACTUAL_KEY,
     '*TBD*' TEAM_ACTUAL_ID,
     PROVIDER_PRODUCT_ID  ,
     DI_PRODUCT_LIBRARY_KEY    ,
     PR_DETAIL_ROW_ID    ,
     CLIENT_PRODUCT_ID   ,
     CL_PRODUCT_LIBRARY_KEY    ,
     CLIENT_BASE_PRODUCT_ID   ,
     CL_BASE_PRODUCT_LIBRARY_KEY    ,
     VAP_ID    ,
     -3 as CURRENCY_KEY ,
     NULL AS CURRENCY_ID ,
     NULL as ORIG_UNITS_DI   ,
     NULL as ORIG_CASE_DI    ,
     RETAIL_UNITS   ,
     RETAIL_CASE_DI  ,
     RETAIL_CASE_EQUIV as RETAIL_CASE_EQ   ,
     NULL as EQUIV_VALUE   ,
     RETAIL_CASE_PHYS  ,
     RETAIL_CASE_STD   ,
     null as RETAIL_AMOUNT   ,
     EXT_PRICE   ,
     PHYS_CLIENT_CASE_FACTOR  ,
     STD_CLIENT_CASE_FACTOR    ,
     PROVIDER_REGION_SALES_ID  ,
     PROVIDER_SALES_REGION   ,
     PROVIDER_SALES_DIVISION_ID  ,
     PROVIDER_SALES_DIVISION   ,
     NULL as LIST_PRICE   ,
     NULL as NET_PRICE   ,
     NULL as DISCOUNT1   ,
     NULL as DISCOUNT2    ,
     NULL as DISCOUNT3    ,
     NULL as DISCOUNT4   ,
     ORIG_CL_WAREHOUSE_ID  ,
     SOURCE_FILE_KEY    ,
     NULL as SOURCE_ROW_ID    ,
     NULL as F_ROW_ID    ,
    R.SOURCE_SYSTEM_ID   ,
    R.ACTIVE_FLAG    ,
    VALPV_ROW_ID    ,
    VERSION    ,
    VALDTL_ROW_ID    ,
    1 PROMPT_FLAG ,
    1 CURRENT_FEED_FLAG ,
    0 DOWNLOAD_FLAG ,
    -2 FILE_KEY ,
    -2 AUDIT_LOAD_KEY,
     R.CREATE_DATE  ,
    'ETL' CREATE_USER_ID ,
    R.UPDATE_DATE  ,
    R.UPDATE_USER_ID ,
     current_timestamp as LOAD_DATE,
 -3 as CLIENT_KEY
,NULL as CLIENT_NAME
from RPT_F_RAD_DETAILS R
left join REL_SR_SALESREP_ORG_STORE SR
  ON SR.STORE_ID = R.STORE_ID
  AND SR.ACTIVE_FLAG = 1
left join D_CL_SALESREP_ORG2_LVL_LL LL
  ON LL.SALESREP_ORG2_LVL_LL_KEY = SR.SALESREP_ORG_LVL_LL_KEY
where  ISNULL(CLIENT_BASE_PRODUCT_ID,'AP00') NOT LIKE 'AP0%'
  and  ROW_ID in (select RPT_ROW_ID from WRK_CDC_RPT_F_RAD_DETAILS where ACTIVE_FLAG = 1);

CREATE VIEW [dbo].[VNEWF_TLU_AP_ACTIVITY]
AS SELECT
ACTIVITY_KEY,
ACTIVITY_DESCR,
ACTIVITY_VAL_HIGH,
ACTIVITY_VAL_LOW,
ACTIVITY_VAL_AVG,
ACTIVITY_SORT,
ACTIVE_FLAG,
      [PROMPT_FLAG]
      ,[CURRENT_FEED_FLAG]
      ,[DOWNLOAD_FLAG]
      ,[FILE_KEY]
      ,[AUDIT_LOAD_KEY]
      , CREATE_DATE
      , CREATE_USER_ID
      , UPDATE_DATE
      , UPDATE_USER_ID
      ,[SOURCE_SYSTEM_ID]
      ,[LOAD_DATE]
  ,-3 as CLIENT_KEY
,NULL as CLIENT_NAME
FROM AP_TRANS.DBO.LU_AP_ACTIVITY;

CREATE VIEW [dbo].[VNEWF_TLU_CL_SALES_ORG1_LEVEL1]
AS SELECT
[SALES_ORG1_LVL1_KEY] AS SALES_ORG1_LEVEL1_KEY
      ,[SALES_ORG1_LVL1_ID] AS SALES_ORG1_LEVEL1_ID
      ,[SALES_ORG1_LVL1_DESCR] AS SALES_ORG1_LEVEL1_DESCR
      ,[CLIENT_KEY]
      ,[CLIENT_NAME]
      ,[SALES_ORG1_LVL1_SORT] AS  SALES_ORG1_LEVEL1_SORT
      ,[SALES_ORG1_LVL1_ACTIVE_FLAG] AS ACTIVE_FLAG
      ,[PROMPT_FLAG]
      ,[CURRENT_FEED_FLAG]
      ,[DOWNLOAD_FLAG]
      ,[FILE_KEY]
      ,[AUDIT_LOAD_KEY]
      , CREATE_DATE
      , 'ETL' AS CREATE_USER_ID
      , UPDATE_DATE
      ,  'ETL' AS UPDATE_USER_ID
      ,[SOURCE_SYSTEM_ID]
      ,[LOAD_DATE]
      ,NULL CLIENT_ID
FROM LU_CL_SALES_ORG1_LVL1;

CREATE VIEW [dbo].[VNEWF_TLU_CL_SALES_ORG2_LEVEL1]
AS SELECT
[SALES_ORG2_LVL1_KEY] AS SALES_ORG2_LEVEL1_KEY
      ,[SALES_ORG2_LVL1_ID] AS SALES_ORG2_LEVEL1_ID
      ,[SALES_ORG2_LVL1_DESCR] AS SALES_ORG2_LEVEL1_DESCR
      ,[CLIENT_KEY]
      ,[CLIENT_NAME]
      ,[SALES_ORG2_LVL1_SORT] AS SALES_ORG2_LEVEL1_SORT
      ,[SALES_ORG2_LVL1_ACTIVE_FLAG] AS ACTIVE_FLAG
      ,[PROMPT_FLAG]
      ,[CURRENT_FEED_FLAG]
      ,[DOWNLOAD_FLAG]
      ,[FILE_KEY]
      ,[AUDIT_LOAD_KEY]
      ,CREATE_DATE
      , 'ETL' AS CREATE_USER_ID
      , UPDATE_DATE
      ,  'ETL' AS UPDATE_USER_ID
      ,[SOURCE_SYSTEM_ID]
      ,[LOAD_DATE]
      ,NULL CLIENT_ID
FROM LU_CL_SALES_ORG2_LVL1;


